/*! { "name": "vissense-percentage-time-test", "version": "0.3.0", "copyright": "(c) 2015 tbk" } */
!function(a,b){"use strict";b(a,a.VisSense,a.VisSense.Utils)}(this,function(a,b,c,d){"use strict";var e=function(a,d,e){var f=0,g=null,h=e.timeLimit,i=e.percentageLimit,j=e.interval;return a.visobj().monitor({strategy:new b.VisMon.Strategy.PollingStrategy({interval:j}),update:function(b){var e=b.state().percentage;if(i>e)g=null;else{var j=c.now();g=g||j,f=j-g}f>=h&&(b.stop(),a.stop(),d())},stop:function(){}})};b.fn.onPercentageTimeTestPassed=function(a,f){var g=c.defaults(f,{percentageLimit:1,timeLimit:1e3,interval:100,strategy:d}),h={monitor:null},i=new b(this.element(),{hidden:g.percentageLimit-.01}).monitor({strategy:g.strategy,update:function(a){},fullyvisible:function(){},visible:function(b){null===h.monitor&&(h.monitor=e(b,a,g)),h.monitor.start()},hidden:function(){null!==h.monitor&&h.monitor.stop()},stop:function(){null!==h.monitor&&h.monitor.stop()}});return i.start(),function(){i.stop()}},b.fn.on50_1TestPassed=function(a,b){return this.onPercentageTimeTestPassed(a,c.extend(b||{},{percentageLimit:.5,timeLimit:1e3,interval:100}))}});